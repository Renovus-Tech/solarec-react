{"ast":null,"code":"import _objectSpread from \"C:/Users/nicob/Desktop/Renovus/solarec2/renovusUnicef/ui_web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"C:/Users/nicob/Desktop/Renovus/solarec2/renovusUnicef/ui_web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\nicob\\\\Desktop\\\\Renovus\\\\solarec2\\\\renovusUnicef\\\\ui_web\\\\src\\\\views\\\\pages\\\\revenue\\\\certificates-and-offsets.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { CCard, CCardBody, CCardHeader, CRow, CCol, CSpinner, CButton } from '@coreui/react';\nimport DataAPI from '../../../helpers/DataAPI.js';\nimport { formatNumber, round, DateFilter } from '../../../helpers/utils.js';\nimport { getCookie } from 'src/helpers/sessionCookie.js';\nimport { Bar } from 'react-chartjs-2';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar ctx = document.getElementById('x');\n\nvar CertificatesAndOffsets = function CertificatesAndOffsets() {\n  _s();\n\n  var _useState = useState('cy'),\n      _useState2 = _slicedToArray(_useState, 2),\n      period = _useState2[0],\n      setPeriod = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      dataLoaded = _useState4[0],\n      setDataLoaded = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      dataLoadError = _useState6[0],\n      setDataLoadError = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var _useState9 = useState({\n    labels: [],\n    datasets: []\n  }),\n      _useState10 = _slicedToArray(_useState9, 2),\n      graphData = _useState10[0],\n      setGraphData = _useState10[1];\n\n  useEffect(function () {\n    fetchData();\n  }, []);\n\n  var fetchData = function fetchData() {\n    setLoading(true);\n    setDataLoaded(false);\n    var body = {};\n    body.location = getCookie('location');\n    body.period = period;\n    DataAPI({\n      'endpoint': 'chart/revenue',\n      'method': 'POST',\n      'body': body\n    }).then(function (response) {\n      setLoading(false);\n\n      if (response.error) {\n        setDataLoadError(true);\n\n        if (response.error.message) {\n          return alert(response.error.message);\n        } else {\n          return alert(response.error);\n        }\n      }\n\n      setDataLoaded(true);\n      if (response.months.length == 0) return;\n      var months = response.months;\n      var graphData = {\n        labels: months.map(function (x, i) {\n          return x.label;\n        }),\n        datasets: [{\n          label: 'CO2 avoided',\n          data: months.map(function (x, i) {\n            return x.coAvoided;\n          }),\n          borderColor: '#9ceb01',\n          backgroundColor: '#9ceb01',\n          type: 'line',\n          yAxisID: 'yCOAvoided',\n          order: 0\n        }, {\n          label: 'D-RECs generated',\n          data: months.map(function (x, i) {\n            return x.dRecGenerated;\n          }),\n          borderColor: '#7a5195',\n          backgroundColor: '#7a5195',\n          yAxisID: 'yProduction',\n          order: 1\n        }, {\n          label: 'D-RECs sold',\n          data: months.map(function (x, i) {\n            return x.dRecSold;\n          }),\n          borderColor: '#bc5090',\n          backgroundColor: '#bc5090',\n          yAxisID: 'yProduction',\n          order: 1\n        }]\n      };\n      setGraphData(graphData);\n    });\n  };\n\n  var options = {\n    responsive: true,\n    animation: {\n      duration: loading ? 0 : 1000\n    },\n    tooltips: {\n      enabled: true\n    }\n  };\n\n  var optionsGraph = _objectSpread(_objectSpread({}, options), {}, {\n    scales: {\n      yCOAvoided: {\n        type: 'linear',\n        display: true,\n        position: 'right',\n        beginAtZero: false\n      },\n      yProduction: {\n        type: 'linear',\n        display: true,\n        position: 'left',\n        grid: {\n          drawOnChartArea: false // only want the grid lines for one axis to show up\n\n        }\n      }\n    },\n    plugins: {\n      tooltip: {\n        mode: 'index',\n        callbacks: {\n          label: function label(tooltipItem, data) {\n            if (tooltipItem.dataset.label == 'CO2 avoided') return tooltipItem.dataset.label + ': ' + formatNumber(round(tooltipItem.raw, 2)) + ' tons';else return tooltipItem.dataset.label + ': ' + round(tooltipItem.raw, 2) + ' MWh';\n          }\n        }\n      }\n    }\n  });\n\n  return /*#__PURE__*/_jsxDEV(CCard, {\n    className: \"mb-4\",\n    children: [/*#__PURE__*/_jsxDEV(CCardHeader, {\n      children: /*#__PURE__*/_jsxDEV(CRow, {\n        children: [/*#__PURE__*/_jsxDEV(CCol, {\n          sm: \"6\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            id: \"diagnostics\",\n            className: \"card-title mb-0\",\n            children: \"Certificates and Offsets\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }, _this), /*#__PURE__*/_jsxDEV(CCol, {\n          sm: \"6\",\n          className: \"text-right d-flex flex-center flex-justify-end\",\n          children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n            className: \"mr-2 ml-4 m-0\",\n            style: {\n              lineHeight: 2.4\n            },\n            children: \"Period\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 17\n          }, _this), /*#__PURE__*/_jsxDEV(DateFilter, {\n            value: period,\n            options: ['cy', 'cy-1', 'cy-2', 'cy-3'],\n            disabled: loading,\n            onChange: function onChange(value) {\n              setPeriod(value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 17\n          }, _this), /*#__PURE__*/_jsxDEV(CButton, {\n            color: \"primary\",\n            disabled: loading,\n            className: \"mr-2 ml-3\",\n            onClick: function onClick() {\n              fetchData();\n            },\n            children: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 17\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(CCardBody, {\n      children: (loading || dataLoaded) && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: /*#__PURE__*/_jsxDEV(CRow, {\n          children: /*#__PURE__*/_jsxDEV(CCol, {\n            children: !loading || dataLoadError ? /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                marginBottom: '50px'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-left\",\n                  style: {\n                    width: '50%'\n                  },\n                  children: \"MWh\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 23\n                }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"text-right\",\n                  style: {\n                    width: '50%'\n                  },\n                  children: \"Tons\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 188,\n                  columnNumber: 23\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 21\n              }, _this), /*#__PURE__*/_jsxDEV(Bar, {\n                data: graphData,\n                options: optionsGraph\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 23\n              }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-center\",\n                style: {\n                  width: '100%'\n                },\n                children: \"Months\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 194,\n                columnNumber: 21\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 19\n            }, _this) : /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-center\",\n              children: /*#__PURE__*/_jsxDEV(CSpinner, {\n                className: \"loading-spinner\",\n                color: \"#321fdb\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 21\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 197,\n              columnNumber: 19\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 9\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 7\n  }, _this);\n};\n\n_s(CertificatesAndOffsets, \"zI1m0LOwDIYNvonasQXzy5NyEoo=\");\n\n_c = CertificatesAndOffsets;\nexport default CertificatesAndOffsets;\n\nvar _c;\n\n$RefreshReg$(_c, \"CertificatesAndOffsets\");","map":{"version":3,"sources":["C:/Users/nicob/Desktop/Renovus/solarec2/renovusUnicef/ui_web/src/views/pages/revenue/certificates-and-offsets.js"],"names":["React","useState","useEffect","CCard","CCardBody","CCardHeader","CRow","CCol","CSpinner","CButton","DataAPI","formatNumber","round","DateFilter","getCookie","Bar","ctx","document","getElementById","CertificatesAndOffsets","period","setPeriod","dataLoaded","setDataLoaded","dataLoadError","setDataLoadError","loading","setLoading","labels","datasets","graphData","setGraphData","fetchData","body","location","then","response","error","message","alert","months","length","map","x","i","label","data","coAvoided","borderColor","backgroundColor","type","yAxisID","order","dRecGenerated","dRecSold","options","responsive","animation","duration","tooltips","enabled","optionsGraph","scales","yCOAvoided","display","position","beginAtZero","yProduction","grid","drawOnChartArea","plugins","tooltip","mode","callbacks","tooltipItem","dataset","raw","lineHeight","value","marginBottom","width"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\n\r\nimport {\r\n  CCard,\r\n  CCardBody,\r\n  CCardHeader,\r\n  CRow,\r\n  CCol,\r\n  CSpinner,\r\n  CButton,\r\n} from '@coreui/react'\r\n\r\nimport DataAPI from '../../../helpers/DataAPI.js'\r\nimport { formatNumber, round, DateFilter } from '../../../helpers/utils.js'\r\nimport { getCookie } from 'src/helpers/sessionCookie.js'\r\n\r\nimport { Bar } from 'react-chartjs-2';\r\n\r\n\r\nconst ctx = document.getElementById('x');\r\n\r\nconst CertificatesAndOffsets = () => {\r\n\r\n  const [period, setPeriod] = useState('cy');\r\n  const [dataLoaded, setDataLoaded] = useState(false);\r\n  const [dataLoadError, setDataLoadError] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [graphData, setGraphData] = useState({\r\n    labels: [],\r\n    datasets: []\r\n  });\r\n\r\n  \r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n\r\n  const fetchData = () => {\r\n\r\n    setLoading(true)\r\n    setDataLoaded(false)\r\n\r\n    const body = {}\r\n    body.location = getCookie('location');\r\n    body.period = period\r\n    \r\n    DataAPI({\r\n      'endpoint': 'chart/revenue',\r\n      'method': 'POST',\r\n      'body': body\r\n    }).then(\r\n      response => {\r\n\r\n\r\n        setLoading(false);\r\n\r\n        if (response.error) {\r\n          setDataLoadError(true);\r\n          if (response.error.message) {\r\n            return(alert(response.error.message))\r\n          } else {\r\n            return(alert(response.error)) \r\n          }\r\n        }\r\n\r\n        setDataLoaded(true);\r\n        if (response.months.length==0) return;\r\n        const months = response.months;\r\n\r\n        const graphData = {\r\n          labels: months.map((x, i) => { return x.label }),\r\n          datasets: [\r\n            {\r\n              label: 'CO2 avoided',\r\n              data: months.map((x, i) => { return x.coAvoided }),\r\n              borderColor: '#9ceb01',\r\n              backgroundColor: '#9ceb01',\r\n              type: 'line',\r\n              yAxisID: 'yCOAvoided',\r\n              order: 0\r\n            },\r\n            {\r\n              label: 'D-RECs generated',\r\n              data: months.map((x, i) => { return x.dRecGenerated }),\r\n              borderColor: '#7a5195',\r\n              backgroundColor: '#7a5195',\r\n              yAxisID: 'yProduction',\r\n              order: 1\r\n            },\r\n            {\r\n              label: 'D-RECs sold',\r\n              data: months.map((x, i) => { return x.dRecSold }),\r\n              borderColor: '#bc5090',\r\n              backgroundColor: '#bc5090',\r\n              yAxisID: 'yProduction',\r\n              order: 1\r\n            },\r\n          ],\r\n        }\r\n\r\n        setGraphData(graphData);\r\n\r\n      }\r\n    );\r\n\r\n  }\r\n\r\n\r\n  const options = {\r\n    responsive: true,\r\n    animation: {duration: loading ? 0 : 1000},\r\n    tooltips: {\r\n      enabled: true\r\n    }\r\n  };\r\n\r\n\r\n  const optionsGraph =  {\r\n                  ...options,\r\n                  scales: {\r\n                    yCOAvoided: {\r\n                      type: 'linear',\r\n                      display: true,\r\n                      position: 'right',\r\n                      beginAtZero: false,\r\n                    },\r\n                    yProduction: {\r\n                      type: 'linear',\r\n                      display: true,\r\n                      position: 'left',\r\n                      grid: {\r\n                        drawOnChartArea: false, // only want the grid lines for one axis to show up\r\n                      },\r\n                    },\r\n                    \r\n                  },\r\n                  plugins: {\r\n                    tooltip: {\r\n                      mode: 'index',\r\n                      callbacks: {\r\n                        label: function(tooltipItem, data) {\r\n                          if (tooltipItem.dataset.label == 'CO2 avoided')\r\n                            return tooltipItem.dataset.label + ': ' + formatNumber(round(tooltipItem.raw,2)) + ' tons';\r\n                          else\r\n                            return tooltipItem.dataset.label + ': ' + round(tooltipItem.raw,2) + ' MWh';\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                };\r\n\r\n\r\n  return (\r\n      <CCard className=\"mb-4\">\r\n\r\n      <CCardHeader>\r\n          <CRow>\r\n            <CCol sm=\"6\">\r\n              <h3 id=\"diagnostics\" className=\"card-title mb-0\">\r\n                Certificates and Offsets\r\n              </h3>\r\n            </CCol>\r\n\r\n            <CCol sm=\"6\" className=\"text-right d-flex flex-center flex-justify-end\">\r\n                <h6 className=\"mr-2 ml-4 m-0\" style={{lineHeight:2.4}}>Period</h6>\r\n                <DateFilter value={period} options={['cy','cy-1','cy-2','cy-3']} disabled={loading} onChange={(value) => { setPeriod(value);}} />\r\n                <CButton color=\"primary\" disabled={loading} className=\"mr-2 ml-3\" onClick={() => { fetchData();}} >Submit</CButton>\r\n            </CCol>\r\n            \r\n          </CRow>\r\n\r\n        </CCardHeader>\r\n\r\n        <CCardBody>\r\n\r\n         { (loading || dataLoaded) &&\r\n          <div>\r\n\r\n            <CRow>\r\n              <CCol>\r\n\r\n                {!loading || dataLoadError ?\r\n                  <div style={{marginBottom:'50px'}}>\r\n                    <div className='d-flex'>\r\n                      <div className=\"text-left\" style={{width: '50%'}}>MWh</div>\r\n                      <div className=\"text-right\" style={{width: '50%'}}>Tons</div>\r\n                    </div>\r\n                      <Bar \r\n                            data={graphData}\r\n                            options={optionsGraph} \r\n                          />\r\n                    <div className=\"text-center\" style={{width: '100%'}}>Months</div>\r\n                  </div>\r\n                : \r\n                  <div className='text-center'>\r\n                    <CSpinner \r\n                      className=\"loading-spinner\"\r\n                      color='#321fdb'\r\n                    />\r\n                  </div>\r\n                }\r\n                \r\n\r\n              </CCol>\r\n            </CRow>\r\n          </div>\r\n         }\r\n          \r\n        </CCardBody>\r\n\r\n      </CCard>\r\n\r\n\r\n\r\n  )\r\n}\r\n\r\nexport default CertificatesAndOffsets"]},"metadata":{},"sourceType":"module"}