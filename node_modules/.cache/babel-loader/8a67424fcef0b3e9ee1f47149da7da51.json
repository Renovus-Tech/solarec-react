{"ast":null,"code":"import _slicedToArray from \"C:/Users/nicob/Desktop/Renovus/renovus/falconer_ui_web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\nicob\\\\Desktop\\\\Renovus\\\\renovus\\\\falconer_ui_web\\\\src\\\\helpers\\\\SessionTimeout.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback, useRef, Fragment } from 'react';\nimport moment from 'moment';\nimport { setCookie, getCookie } from './sessionCookie.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar SessionTimeout = function SessionTimeout() {\n  _s();\n\n  var _useState = useState(['click', 'load', 'scroll']),\n      _useState2 = _slicedToArray(_useState, 2),\n      events = _useState2[0],\n      setEvents = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      second = _useState4[0],\n      setSecond = _useState4[1];\n\n  var timeStamp;\n  var userInactiveInterval = useRef();\n  var startTimerInterval = useRef();\n  var authenticated = getCookie('name') !== false && getCookie('name') !== ''; // start inactive check\n\n  var timeChecker = function timeChecker() {\n    startTimerInterval.current = setTimeout(function () {\n      var storedTimeStamp = getCookie('lastTimeStamp'); //sessionStorage.getItem('lastTimeStamp');\n\n      userInactive(storedTimeStamp);\n    }, 60000);\n  }; // inactive timer\n\n\n  var userInactive = function userInactive(timeString) {\n    clearTimeout(startTimerInterval.current);\n    userInactiveInterval.current = setInterval(function () {\n      var maxTime = 540; // Maximum ideal time given before logout \n      // const popTime = 1; // remaining time (notification) left to logout.\n\n      var diff = moment.duration(moment().diff(moment(timeString)));\n      var minPast = diff.minutes(); // const leftSecond = 60 - diff.seconds();\n      // if (minPast === popTime) {\n      //     setSecond(leftSecond);\n      // }\n\n      if (minPast === maxTime) {\n        clearInterval(userInactiveInterval.current);\n        setCookie('lastTimeStamp', '');\n        setCookie('name', '');\n        window.location.reload();\n      }\n    }, 1000);\n  }; // reset interval timer\n\n\n  var resetTimer = useCallback(function () {\n    clearTimeout(startTimerInterval.current);\n    clearInterval(userInactiveInterval.current);\n\n    if (authenticated) {\n      timeStamp = moment();\n      setCookie('lastTimeStamp', timeStamp);\n    } else {\n      clearInterval(userInactiveInterval.current);\n      setCookie('lastTimeStamp', '');\n    }\n\n    timeChecker();\n  }, [authenticated]);\n  useEffect(function () {\n    events.forEach(function (event) {\n      window.addEventListener(event, resetTimer);\n    });\n    timeChecker();\n    return function () {\n      clearTimeout(startTimerInterval.current);\n    };\n  }, [resetTimer, events, timeChecker]);\n  return /*#__PURE__*/_jsxDEV(Fragment, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 12\n  }, _this);\n};\n\n_s(SessionTimeout, \"rdvxdpzVq+awAgCADoBx/PEWCzM=\");\n\n_c = SessionTimeout;\nexport default SessionTimeout;\n\nvar _c;\n\n$RefreshReg$(_c, \"SessionTimeout\");","map":{"version":3,"sources":["C:/Users/nicob/Desktop/Renovus/renovus/falconer_ui_web/src/helpers/SessionTimeout.js"],"names":["React","useState","useEffect","useCallback","useRef","Fragment","moment","setCookie","getCookie","SessionTimeout","events","setEvents","second","setSecond","timeStamp","userInactiveInterval","startTimerInterval","authenticated","timeChecker","current","setTimeout","storedTimeStamp","userInactive","timeString","clearTimeout","setInterval","maxTime","diff","duration","minPast","minutes","clearInterval","window","location","reload","resetTimer","forEach","event","addEventListener"],"mappings":"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","sourcesContent":["import React, {\r\n    useState,\r\n    useEffect,\r\n    useCallback,\r\n    useRef,\r\n    Fragment,\r\n  } from 'react';\r\nimport moment from 'moment';\r\nimport {setCookie,getCookie} from './sessionCookie.js'\r\n  \r\nconst SessionTimeout =()=> {\r\n\r\n    const [events, setEvents] = useState(['click', 'load', 'scroll']);\r\n    const [second, setSecond] = useState(0);\r\n\r\n    let timeStamp;\r\n    let userInactiveInterval = useRef();\r\n    let startTimerInterval = useRef();\r\n    let authenticated = getCookie('name')!==false && getCookie('name')!=='';\r\n\r\n    // start inactive check\r\n    let timeChecker = () => {\r\n        startTimerInterval.current = setTimeout(() => {\r\n            let storedTimeStamp = getCookie('lastTimeStamp'); //sessionStorage.getItem('lastTimeStamp');\r\n            userInactive(storedTimeStamp);\r\n        }, 60000);\r\n    };\r\n\r\n    // inactive timer\r\n    let userInactive = (timeString) => {\r\n        clearTimeout(startTimerInterval.current);\r\n    \r\n        userInactiveInterval.current = setInterval(() => {\r\n        const maxTime = 540; // Maximum ideal time given before logout \r\n        // const popTime = 1; // remaining time (notification) left to logout.\r\n    \r\n        const diff = moment.duration(moment().diff(moment(timeString)));\r\n        const minPast = diff.minutes();\r\n        // const leftSecond = 60 - diff.seconds();\r\n    \r\n        // if (minPast === popTime) {\r\n        //     setSecond(leftSecond);\r\n        // }\r\n    \r\n        if (minPast === maxTime) {\r\n            clearInterval(userInactiveInterval.current);\r\n            setCookie('lastTimeStamp', '');\r\n            setCookie('name', '');\r\n            window.location.reload();\r\n        }\r\n        }, 1000);\r\n    };\r\n\r\n    // reset interval timer\r\n    let resetTimer = useCallback(() => {\r\n        clearTimeout(startTimerInterval.current);\r\n        clearInterval(userInactiveInterval.current);\r\n    \r\n        if (authenticated) {\r\n            timeStamp = moment();\r\n            setCookie('lastTimeStamp', timeStamp);\r\n        } else {\r\n            clearInterval(userInactiveInterval.current);\r\n            setCookie('lastTimeStamp', '');\r\n        }\r\n        timeChecker();\r\n    }, [authenticated]);\r\n    \r\n    \r\n    useEffect(() => {\r\n        events.forEach((event) => {\r\n            window.addEventListener(event, resetTimer);\r\n        });\r\n    \r\n        timeChecker();\r\n    \r\n        return () => {\r\n            clearTimeout(startTimerInterval.current);\r\n        };\r\n    }, [resetTimer, events, timeChecker]);\r\n\r\n\r\n    return <Fragment />;\r\n};\r\n\r\nexport default SessionTimeout;"]},"metadata":{},"sourceType":"module"}