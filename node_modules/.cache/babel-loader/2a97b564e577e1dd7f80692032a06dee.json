{"ast":null,"code":"import _slicedToArray from \"C:/Users/nicob/Desktop/Renovus/renovus/falconer_ui_web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\nicob\\\\Desktop\\\\Renovus\\\\renovus\\\\falconer_ui_web\\\\src\\\\views\\\\pages\\\\curtailments\\\\curtailments.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { CCard, CCardBody, CCardGroup, CCardHeader, CRow, CCol } from '@coreui/react';\nimport { CChartBar, CChartLine, CChartDoughnut, CChartRadar, CChartPie, CChartPolarArea } from '@coreui/react-chartjs';\nimport { DocsLink } from 'src/reusable';\nimport DataAPI from '../../../helpers/DataAPI.js';\nimport { DateFilter, getDateLabel, formatDate } from '../../../helpers/utils.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Charts = function Charts() {\n  _s();\n\n  var _useState = useState('12w'),\n      _useState2 = _slicedToArray(_useState, 2),\n      dateRange = _useState2[0],\n      setDateRange = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      loading = _useState4[0],\n      setLoading = _useState4[1];\n\n  var _useState5 = useState({\n    labels: [],\n    datasets: []\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      graphData = _useState6[0],\n      setGraphData = _useState6[1];\n\n  useEffect(function () {\n    refreshChart(dateRange);\n  }, []);\n\n  var refreshChart = function refreshChart(dateRange) {\n    setLoading(true);\n    var body = {};\n\n    if (dateRange && dateRange.split('--').length == 2) {\n      body.from = dateRange.split('--')[0];\n      body.to = dateRange.split('--')[1];\n    } else {\n      body.period = dateRange;\n    }\n\n    DataAPI({\n      'endpoint': 'chart/curtailments',\n      'body': body\n    }).then(function (responseData) {\n      setLoading(false);\n\n      if (responseData.error) {\n        if (responseData.error.message) {\n          return alert(responseData.error.message);\n        } else {\n          return alert(responseData.error);\n        }\n      }\n\n      var data = {\n        labels: [],\n        datasets: []\n      };\n      responseData.dataSet.forEach(function (rDs) {\n        var datasets = {\n          label: rDs.label,\n          backgroundColor: rDs.id === 1 ? '#f87979' : '#0400ff',\n          data: []\n        };\n        responseData.data.forEach(function (rD) {\n          var dsData = rD.dataSet.find(function (dS) {\n            return dS.id === rDs.id;\n          });\n          var value = (Math.round(dsData.value * 100) / 100).toFixed(2);\n          datasets.data.push(value);\n        });\n        data.datasets.push(datasets);\n      });\n      responseData.data.forEach(function (rD) {\n        var rDfrom = rD.from;\n        var rDto = rD.to; // data.labels.push(rDfrom.replace(\" 00:00:00\", \"\") + ' / ' + rDto.replace(\" 00:00:00\", \"\"));\n\n        data.labels.push(\"\".concat(formatDate(rDfrom), \" - \").concat(formatDate(rDto)));\n      });\n      setGraphData(data);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(CCard, {\n    children: [/*#__PURE__*/_jsxDEV(CCardHeader, {\n      children: /*#__PURE__*/_jsxDEV(CRow, {\n        children: [/*#__PURE__*/_jsxDEV(CCol, {\n          sm: \"6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            id: \"traffic\",\n            className: \"card-title mb-0\",\n            children: \"Curtailments\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"small text-medium-emphasis\",\n            children: getDateLabel(dateRange)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 15\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, _this), /*#__PURE__*/_jsxDEV(CCol, {\n          sm: \"6\",\n          class: \"text-right\",\n          children: /*#__PURE__*/_jsxDEV(DateFilter, {\n            value: dateRange,\n            options: ['y', 'cm', 'cy', '12w', '12m', 'x'],\n            disabled: loading,\n            onChange: function onChange(value) {\n              setDateRange(value);\n              refreshChart(value);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(CCardBody, {\n      children: [\"MWh\", /*#__PURE__*/_jsxDEV(CChartBar, {\n        datasets: graphData.datasets,\n        labels: graphData.labels,\n        options: {\n          tooltips: {\n            enabled: true\n          }\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(\"p\", {\n        class: \"text-center\",\n        children: \"Week\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Charts, \"CBPg6qDsGl/54dS1QAHx1Hhha2A=\");\n\n_c = Charts;\nexport default Charts;\n\nvar _c;\n\n$RefreshReg$(_c, \"Charts\");","map":{"version":3,"sources":["C:/Users/nicob/Desktop/Renovus/renovus/falconer_ui_web/src/views/pages/curtailments/curtailments.js"],"names":["React","useState","useEffect","CCard","CCardBody","CCardGroup","CCardHeader","CRow","CCol","CChartBar","CChartLine","CChartDoughnut","CChartRadar","CChartPie","CChartPolarArea","DocsLink","DataAPI","DateFilter","getDateLabel","formatDate","Charts","dateRange","setDateRange","loading","setLoading","labels","datasets","graphData","setGraphData","refreshChart","body","split","length","from","to","period","then","responseData","error","message","alert","data","dataSet","forEach","rDs","label","backgroundColor","id","rD","dsData","find","dS","value","Math","round","toFixed","push","rDfrom","rDto","tooltips","enabled"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport {\r\n  CCard,\r\n  CCardBody,\r\n  CCardGroup,\r\n  CCardHeader,\r\n  CRow,\r\n  CCol\r\n} from '@coreui/react'\r\nimport {\r\n  CChartBar,\r\n  CChartLine,\r\n  CChartDoughnut,\r\n  CChartRadar,\r\n  CChartPie,\r\n  CChartPolarArea\r\n} from '@coreui/react-chartjs'\r\nimport { DocsLink } from 'src/reusable'\r\n\r\nimport DataAPI from '../../../helpers/DataAPI.js'\r\n\r\nimport {DateFilter, getDateLabel, formatDate} from '../../../helpers/utils.js'\r\n\r\nconst Charts = () => {\r\n\r\n  const [dateRange, setDateRange] = useState('12w');\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const [graphData, setGraphData] = useState({\r\n    labels: [],\r\n    datasets: []\r\n  });\r\n\r\n  useEffect(() => {\r\n      \r\n      refreshChart(dateRange);\r\n\r\n  }, []);\r\n\r\n\r\n  const refreshChart = (dateRange) => {\r\n\r\n    setLoading(true);\r\n\r\n    const body = {}\r\n    \r\n    if (dateRange && dateRange.split('--').length==2) {\r\n      body.from = dateRange.split('--')[0]\r\n      body.to = dateRange.split('--')[1]\r\n    } else {\r\n      body.period = dateRange\r\n    }\r\n\r\n    DataAPI(\r\n      {\r\n      'endpoint': 'chart/curtailments',\r\n      'body': body\r\n    }).then(function (responseData) {\r\n\r\n\r\n      setLoading(false);\r\n\r\n      if (responseData.error) {\r\n           if (responseData.error.message) {\r\n            return(alert(responseData.error.message))\r\n           } else {\r\n            return(alert(responseData.error)) \r\n           }\r\n        }\r\n\r\n\r\n        const data = {\r\n          labels: [],\r\n          datasets: []\r\n        }\r\n        responseData.dataSet.forEach((rDs) => {\r\n          const datasets = {\r\n            label: rDs.label,\r\n            backgroundColor: rDs.id === 1 ? '#f87979' : '#0400ff',\r\n            data: []\r\n          };\r\n          responseData.data.forEach((rD) => {\r\n            const dsData = rD.dataSet.find((dS) => dS.id === rDs.id);\r\n            const value = (Math.round(dsData.value * 100) / 100).toFixed(2);\r\n            datasets.data.push(value);\r\n          });\r\n          data.datasets.push(datasets);\r\n        });\r\n\r\n        responseData.data.forEach((rD) => {\r\n          const rDfrom = rD.from;\r\n          const rDto = rD.to;\r\n          // data.labels.push(rDfrom.replace(\" 00:00:00\", \"\") + ' / ' + rDto.replace(\" 00:00:00\", \"\"));\r\n          data.labels.push(`${formatDate(rDfrom)} - ${formatDate(rDto)}`);\r\n\r\n        });\r\n        setGraphData(data)\r\n      });\r\n\r\n\r\n  }\r\n\r\n  return (\r\n    <CCard>\r\n      <CCardHeader>\r\n          <CRow>\r\n            <CCol sm=\"6\">\r\n              <h4 id=\"traffic\" className=\"card-title mb-0\">\r\n                Curtailments\r\n              </h4>\r\n              <div className=\"small text-medium-emphasis\">{getDateLabel(dateRange)}</div>\r\n              </CCol>\r\n            \r\n\r\n            <CCol sm=\"6\" class=\"text-right\">\r\n              <DateFilter value={dateRange} options={['y','cm','cy','12w','12m','x']} disabled={loading} onChange={(value) => { setDateRange(value); refreshChart(value);}} />\r\n            </CCol>\r\n                            </CRow>\r\n\r\n\r\n        </CCardHeader>\r\n      <CCardBody>\r\n        MWh\r\n        <CChartBar\r\n          datasets={graphData.datasets}\r\n          labels={graphData.labels}\r\n          options={{\r\n            tooltips: {\r\n              enabled: true\r\n            }\r\n          }}\r\n        />\r\n        <p class=\"text-center\">Week</p>\r\n      </CCardBody>\r\n    </CCard>\r\n  )\r\n}\r\n\r\nexport default Charts\r\n"]},"metadata":{},"sourceType":"module"}